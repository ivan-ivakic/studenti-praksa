@mixin st-preformat {

  // padding-top: 1px; // Fix for negative margin on headers
  line-height: $st-preformat-line-height;
  letter-spacing: .01em;

  p {
    &.lead {
      font-size: 1.1em;
      font-weight: 300;
      @include large { font-size: 1.2em; }
    }
  }

  b, strong {
    font-weight: bold;
    color: $text-color-dark;
  }

  small {
    font-size: $textSmaller;
    color: $text-color-light;
  }

  a{ @extend .link !optional; }


  ul { @include st-ul; }
  ol { @include st-ol; }
  dl { @include st-dl; }


  // Compact list modifier
  ul.-compact li,
  ol.-compact li {
    margin-bottom: 0.25rem;
  }


  img {
    margin-left: auto;
    margin-right: auto;
  }

  // Standardize margins for everything
  p, ul, ol, dl, pre, blockquote, iframe, > figure, > img {
    margin-top: 0;
    margin-bottom: $st-preformat-gap;
  }

  #{$st-headers} {
    margin-top: ($st-preformat-gap * 1.5);
  }

  h1{ margin-bottom: ($st-preformat-gap / 1.5); }
  h2{ margin-bottom: ($st-preformat-gap / 3); }
  h3, h4{ margin-bottom: ($st-preformat-gap / 4); }
  h5, h6{ margin-bottom: ($st-preformat-gap / 6); }

  hr {
    display: block;
    margin: ($st-preformat-gap * 2.5) auto ($st-preformat-gap * 2.2);
    width: 20%;
    height: 1px;
    background: shade($neutral-light, 5%);
    border: 0;
  }

  // Remove margins for certain cases
  > h1:first-child, > h2:first-child, > h3:first-child, > h4:first-child, > h5:first-child, > h6:first-child{ margin-top: -0.2em; }
  > :last-child{ margin-bottom:0 !important; }

  // Compact modifier for some design elements
  &.-compact {
    line-height: $st-preformat-line-height / 1.05;
    #{$st-headers}{
      margin-top: ($st-preformat-gap * 1.5) / 2;
      margin-bottom: 0;
    }
    p, ul, ol, pre, blockquote, iframe, > figure, > img { margin-bottom: ($st-preformat-gap / 2); }
    > :first-child{ margin-top: -0.22em; }
  }

}



@mixin st-preformatExtras {

  #{$st-headers} {
    // Directly after headers, these elements have a bit of margin-top
    + ul, + ol, + pre{
      margin-top: $st-preformat-gap / 2.5;
    }
  }

  figure {
    // display: table;
    // table-layout: fixed;
    position: relative;
    margin-left: -($st-grid-spacing / 2);
    margin-right: -($st-grid-spacing / 2);
    padding: 0;
    text-align: center;

    // div {
    //   display: table-cell;
    //   width: 100%;
    // }

      img {
        display: block;
        width: 100%;
        max-width: 100%;
        margin: 0 auto;
      }

      figcaption {
        // display: table-caption;
        // caption-side: bottom;
        margin-left: auto;
        margin-right: auto;
        padding-left: $st-grid-spacing / 2;
        padding-right: $st-grid-spacing / 2;
        padding-top: ($st-preformat-gap / 1.5);
        font-family: $st-serif-font-family;
        font-size: 0.95em;
        font-style: italic;
        text-align: $st-align;
      }
  }

  @include medium {
    figure {
      margin-left: auto;
      margin-right: auto;
      width: 100%;

      img {
        width: auto;
      }

      figcaption {
        position: absolute;
        left: 0;
        bottom: 0;
        right: 0;
        padding: 1em;
      }
    }
  }

  abbr {
    cursor: help;
    border-bottom: 1px dotted $st-text-light;
  }

  del, s {
    text-decoration: line-through;
  }

  code {
    // display: inline;
    padding: .1em .2em;
    // font-weight: bold;
    font-family: $st-monospace-font-family;
    font-size: 0.95em;
    color: $secondary;
    line-height: $st-preformat-line-height - 0.3;
    background: tint($st-secondary, 90%);
  }

  kbd {
    display: inline-block;
    margin: 0 .1em;
    border: 1px solid #CCC;
    padding: .22em .4em;
    font-size: $st-text-smaller;
    font-weight: bold;
    color: $text-color-light;
    text-transform: uppercase;
    line-height: 1;
    vertical-align: 1px;
    background-color: #f2f2f2;
    box-shadow: 0 1px 0 rgba(black, 0.2);
    border-radius: 3px;
    text-shadow: 0 1px 0 #FFF;
    white-space: nowrap;
  }

  blockquote{ margin:0; padding:.5em 1.1em .25em 1.05em; font-size:0.95em; border-left:1px solid #DDD; color:$text-color-light;
    cite{ display:block; margin-top:0.25em; font-size:0.8em;
      &:before{ margin-right:0.4em; content:'â€”'; }
    }
  }

  pre {
    padding: 1em;
    background: #f7f7f7;
    border: 1px solid #e8e8e8;
    overflow: auto;
    text-rendering: optimizeSpeed;
  }
    pre code {
      display: block;
      padding: 0 !important;
      font-size: 0.9em;
      font-family: $st-monospace-font-family;
      font-weight: inherit;
      color: inherit;
      line-height: 1.45;
      white-space: pre;
      text-rendering: optimizeSpeed;
      background: none;
    }

}
